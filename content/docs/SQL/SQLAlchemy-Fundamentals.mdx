---
title: "SQLAlchemy Fundamentals â€” A Beginner-Friendly Guide"
description: "Understand SQLAlchemy step by step: Core vs ORM, database connections, session management, model definitions, and relationship mapping â€” with real-world examples."
date: "2025-11-13"
tags: ["Python", "SQLAlchemy", "Database", "ORM", "Backend"]
---

# ğŸ§© SQLAlchemy Fundamentals  
*A complete and simple guide to understanding how Python interacts with databases.*

---

## ğŸ§  What is SQLAlchemy?

**SQLAlchemy** is a Python library used to work with databases in a clean, consistent way.  
It helps developers write Python code instead of long, complex SQL queries â€” while still being powerful and flexible.

ğŸ’¡ **Think of it like this:**  
- Without SQLAlchemy â†’ You write SQL manually  
- With SQLAlchemy â†’ You use Python objects and functions that generate SQL automatically  

Itâ€™s like talking to your database in **Pythonâ€™s language**.

---

## ğŸ§± Why Use SQLAlchemy?

SQLAlchemy provides:
- âœ… Easier code maintenance  
- âœ… Database independence (works with MySQL, PostgreSQL, SQLite, etc.)  
- âœ… Built-in security (avoids SQL injection)  
- âœ… Clean data handling using Python classes  

ğŸ’¡ **Real-World Example:**  
A FastAPI app managing tasks or users uses SQLAlchemy to store data in a database â€” without manually writing `INSERT` or `SELECT` SQL.

---

## âš™ï¸ 1. Core vs ORM â€” The Two Faces of SQLAlchemy  

SQLAlchemy has **two main layers**:  

| Feature | SQLAlchemy Core | SQLAlchemy ORM |
|----------|------------------|----------------|
| Style | Write SQL using Python syntax | Write Python classes and objects |
| Use Case | Simple or raw queries | Complex, object-based data models |
| Example | `select(users)` | `db.query(User).all()` |

---

### ğŸ”¸ SQLAlchemy Core (Manual but Powerful)

In **Core**, you define tables and write SQL-like commands using Python.

```python
from sqlalchemy import create_engine, Table, Column, Integer, String, MetaData, select

engine = create_engine("sqlite:///example.db")
metadata = MetaData()

users = Table(
    "users", metadata,
    Column("id", Integer, primary_key=True),
    Column("name", String),
)

metadata.create_all(engine)

# Insert and read
with engine.connect() as conn:
    conn.execute(users.insert().values(name="Safi"))
    result = conn.execute(select(users))
    print(result.fetchall())
````

ğŸ’¬ Youâ€™re still writing SQL â€” just in Python syntax.

---

### ğŸ”¹ SQLAlchemy ORM (Object-Relational Mapper)

ORM turns database tables into **Python classes** â€”
so you can interact with the database as if it were just Python objects.

```python
from sqlalchemy.orm import DeclarativeBase, Session, Mapped, mapped_column
from sqlalchemy import create_engine, String

class Base(DeclarativeBase): pass

class User(Base):
    __tablename__ = "users"
    id: Mapped[int] = mapped_column(primary_key=True)
    name: Mapped[str] = mapped_column(String)

engine = create_engine("sqlite:///example.db")
Base.metadata.create_all(engine)

with Session(engine) as session:
    session.add(User(name="Rukhya"))
    session.commit()
```

ğŸ’¡ Instead of thinking about tables and rows, you think in terms of **objects and classes**.
This makes ORM perfect for web apps built with **FastAPI**, **Flask**, or **Django**.

---

## ğŸ”Œ 2. Database Connections

SQLAlchemy connects Python to your chosen database through something called an **Engine**.

Think of the **engine** as the bridge between your code and the database.

---

### ğŸ”¸ Example

```python
from sqlalchemy import create_engine

# SQLite (local file database)
engine = create_engine("sqlite:///tasks.db", echo=True)
```

Here:

* `sqlite:///tasks.db` â†’ Database URL
* `echo=True` â†’ Prints SQL statements (helpful for debugging)

---

### ğŸ”¹ Other Database URLs

| Database   | Example URL                                      |
| ---------- | ------------------------------------------------ |
| SQLite     | `sqlite:///data.db`                              |
| PostgreSQL | `postgresql://user:password@localhost/dbname`    |
| MySQL      | `mysql+pymysql://user:password@localhost/dbname` |

ğŸ’¡ **Real-World Example:**
Your FastAPI app might use PostgreSQL in production but SQLite for local testing.
SQLAlchemy makes it easy to switch by just changing the URL.

---

## ğŸŒ€ 3. Session Management

### ğŸ”¹ What is a Session?

A **Session** represents a single â€œconversationâ€ with your database.
You use it to:

* Add new data
* Query data
* Commit changes
* Rollback if something goes wrong

Think of it like a â€œdraft editorâ€ â€”
you collect all your changes, then save (commit) them at once.

---

### ğŸ”¸ Example

```python
from sqlalchemy.orm import Session
from models import User, engine

session = Session(engine)

# Add new data
user = User(name="Safi")
session.add(user)

# Commit to save changes
session.commit()
```

ğŸ’¡ **Analogy:**
A session is like a shopping cart â€”
you add items (database changes), and when ready, you check out (commit).

---

### ğŸ”¹ Closing Sessions

Always close sessions after use to prevent memory leaks.

```python
session.close()
```

ğŸ’¡ **Pro Tip:**
Use **context managers** to handle this automatically:

```python
with Session(engine) as session:
    session.add(User(name="Ayaan"))
    session.commit()
```

---

## ğŸ§© 4. Model Definitions

### ğŸ”¹ The Concept

A **model** is a Python class that represents a table in your database.
Each attribute in the class corresponds to a column in the table.

---

### ğŸ”¸ Example

```python
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column
from sqlalchemy import String, Integer

class Base(DeclarativeBase): pass

class Task(Base):
    __tablename__ = "tasks"
    id: Mapped[int] = mapped_column(Integer, primary_key=True)
    title: Mapped[str] = mapped_column(String(100))
    status: Mapped[str] = mapped_column(String(20), default="pending")
```

ğŸ’¬ This creates a table called `tasks` with three columns:
`id`, `title`, and `status`.

---

ğŸ’¡ **Real-World Example:**
In a **Task Tracker App**, youâ€™d have models like:

* `User`
* `Task`
* `Project`

Each would map directly to a database table.

---

### ğŸ”¹ Benefits of Using Models

| Benefit              | Description                          |
| -------------------- | ------------------------------------ |
| âœ… Clean and readable | Pythonic structure                   |
| ğŸ” Secure            | Avoids SQL injection                 |
| ğŸ’¾ Easy migration    | Works across databases               |
| âš™ï¸ Maintainable      | Change code once, reflect everywhere |

---

## ğŸ”— 5. Relationship Mapping

### ğŸ”¹ The Concept

Databases often have relationships between tables:

* One user â†’ Many tasks
* One project â†’ Many users

SQLAlchemy handles these with **Foreign Keys** and **Relationships**.

---

### ğŸ”¸ Example: One-to-Many

```python
from sqlalchemy.orm import relationship, Mapped, mapped_column
from sqlalchemy import ForeignKey

class User(Base):
    __tablename__ = "users"
    id: Mapped[int] = mapped_column(primary_key=True)
    name: Mapped[str]
    tasks: Mapped[list["Task"]] = relationship("Task", back_populates="owner")

class Task(Base):
    __tablename__ = "tasks"
    id: Mapped[int] = mapped_column(primary_key=True)
    title: Mapped[str]
    owner_id: Mapped[int] = mapped_column(ForeignKey("users.id"))
    owner: Mapped["User"] = relationship("User", back_populates="tasks")
```

ğŸ’¡ **What Happens:**

* Each task belongs to one user
* A user can have many tasks

Now, you can access:

```python
user.tasks  # All tasks for a user
task.owner  # User who owns this task
```

---

ğŸ’¡ **Real-World Example:**
In **Asana** or **Trello**, one user can create multiple tasks â€”
this is exactly how â€œone-to-manyâ€ works behind the scenes.

---

### ğŸ”¹ Relationship Types

| Relationship | Example           | Description                          |
| ------------ | ----------------- | ------------------------------------ |
| One-to-One   | User â†” Profile    | Each user has one profile            |
| One-to-Many  | User â†” Tasks      | One user can have many tasks         |
| Many-to-Many | Student â†” Courses | Many students enroll in many courses |

---

## ğŸ§¾ Summary

| Concept              | Description                     | Real-World Example                           |
| -------------------- | ------------------------------- | -------------------------------------------- |
| Core vs ORM          | Two ways to work with databases | ORM used in FastAPI apps                     |
| Database Connections | Connect Python to your DB       | SQLite for testing, PostgreSQL in production |
| Session Management   | Add, commit, rollback safely    | Like a shopping cart before checkout         |
| Model Definitions    | Map Python classes to tables    | Task, User, Project models                   |
| Relationship Mapping | Link data between tables        | User â†’ Tasks in a to-do app                  |

---

## ğŸ’¡ Final Thought

SQLAlchemy bridges Python and the database world.
It gives you **control like raw SQL** and **convenience like Python objects**.

Once you master it, building backend apps with **FastAPI**, **Flask**, or even **Django ORM alternatives** becomes smooth, secure, and scalable.

ğŸ’¬ â€œDatabases are powerful â€” SQLAlchemy just makes them human-friendly.â€

---

